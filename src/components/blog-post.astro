---
import { Image } from 'astro:assets';
import clsx from 'clsx';

type Image = {
    url: string;
    alt: string;
}

export interface Props {
    title: string;
    description?: string;
    url: string;
    date?: string | Date;
    image?: {
        url: {
            height: number;
            src: string;
            width: number;
            format: "svg" | "png" | "jpg" | "jpeg" | "tiff" | "webp" | "gif" | "avif";
        };
        alt: string;
    } | undefined;
}

const { title, url, image, description, date } = Astro.props;
---

<a href={url} role="article" rel="prefetch-intent" class={clsx(
    "group flex flex-col items-start justify-between h-full bg-white/5 border border-white/10 rounded-2xl overflow-hidden hover:border-white/20 transition-all duration-500 hover:shadow-[0_0_30px_rgba(255,255,255,0.05)]",
)}>
    <div class="relative w-full overflow-hidden aspect-video sm:aspect-2/1 lg:aspect-3/2">
        {image && (
            <Image 
                class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" 
                src={image.url} 
                alt={image.alt} 
                width={600} 
                quality={80} 
            />
        )}
        <div class="absolute inset-0 bg-gradient-to-t from-[#0a0a0a] via-transparent to-transparent opacity-60"></div>
    </div>
    
    <div class="flex-1 p-6 relative">
        <div class="absolute top-0 right-0 p-6 opacity-0 group-hover:opacity-100 transition-opacity duration-300 transform -translate-y-2 group-hover:translate-y-0">
             <div class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center backdrop-blur-md">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-white" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                </svg>
             </div>
        </div>

        <div class="flex items-center gap-x-4 text-xs">
            <time datetime={date?.toString()} class="text-muted-foreground">{new Date(date ?? "").toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</time>
        </div>

        <h3 class="mt-3 text-xl font-bold leading-snug text-white group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-white group-hover:to-gray-400 transition-all duration-300 font-serif">
            {title}
        </h3>
        <p class="mt-3 line-clamp-3 text-sm leading-relaxed text-muted-foreground font-sans group-hover:text-gray-300 transition-colors">
            {description}
        </p>
    </div>
</a>
